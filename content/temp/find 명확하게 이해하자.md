---
title: find 명확하게 이해하자
resource-path: temp/find 명확하게 이해하자.md
keywords:
  - find
tags:
  - shell
  - command
date: 2024-03-02T14:44:00+09:00
lastmod: 2024-03-02T14:44:00+09:00
---
어떤 폴더를 제외하고 파일을 찾고자 -not -path 옵션을 사용했지만 접근 불가능한 파일(proc 내부의 파일들)에 접근하려고 해서 오류(Permission denied)를 뿜어내서 찾아보게 되었다
하지만 생각보다 조금 내용이 복잡한 것 같아 완벽하게 정리해 보고자 한다

find 명령이 하는 일이 단순하게 2가지를 한다고 이해하면
- 찾는 것 ~= 탐색하는 것
- 탐색의 나열중 조건에 맞는 것을 출력하는 것
2가지 이다

find 기본 문법
```shell
find {option} {starting pointing} {expression} ...
```
- option
- starting pointing : find 명령의 시작 위치
- expression: 조건 여러가지 종류가 존재
	- 테스트(Tests) : 파일의 속성에 기반한 true false 값 반환
		- ex) -name 'stdio.h' => 이름이 stdio.h 인 경우 true 
	- 동작(Actions) : T/F 반환 이외의 std 출력과 같은 부가적이 동작이 있음 그리고 그 부가적인 동작의 성공 여부에 따라 T/F 를 반환
		- ex) -path '/include' -prune => '/include' 폴더의 내부는 탐색하지 않는다 또한 전체의 결과는 true 이다
	- 전역 옵션(Global options) 전역 옵션은 명령 줄의 어느 부분에서도 지정된 테스트 및 동작의 작동에 영향을 줍니다. 전역 옵션은 항상 true를 반환합니다. 예를 들어 -depth 옵션은 find가 파일 시스템을 깊이 우선 순서로 탐색하도록 만듭니다.
	- 위치 옵션(Positional options) 위치 옵션은 그들 뒤에 따라오는 테스트 또는 동작에만 영향을 미칩니다. 위치 옵션은 항상 true를 반환합니다. 예를 들어 -regextype 옵션은 위치 지정이며, 명령 줄에서 나중에 발생하는 정규 표현식에 대해 정규 표현식 방언을 지정합니다.
	- 연산자(Operators) 연산자는 표현 내의 다른 항목들을 결합합니다. 예를 들어 -o(논리 OR를 의미함)와 -a(논리 AND를 의미함)가 있습니다. 연산자가 누락된 경우 -a가 가정됩니다.

`/usr` 폴더에서 `/usr/bin` 출력하지도 탐색하지도 않고 이름이 stdio.h 인 파일을 찾는다
`find /usr -not \( -path '/usr/bin' -prune \)  -name 'stdio.h'`
- / 에서 시작한다
- -path 옵션을 통해 `/usr/bin` 와 일치하는 것을 찾는다 
- -prune 옵션을 통해 찾은 파일이 디렉토리인 경우 더이상 탐색하지 않는다 그러므로 `/usr/bin` 폴더 만이 찾아진다
- -not 옵션을 통해 -path 옵션을 통해 찾은 폴더는 false 이다
- -name 옵션을 통해 이름이 'stdio.h' 인 파일을 찾는다
  
  
  
  이 코드는 표현식 트리를 구성하는 함수입니다. 주요 작업은 다음과 같습니다:
1. **표현식 파싱**: 입력된 인수들을 파싱하여 표현식을 구성합니다. 각각의 인수는 특정 조건을 나타내는 'predicate’로 처리됩니다. 이 과정에서 `find_parser` 함수를 사용하여 각 인수에 대한 파서를 찾고, 해당 파서의 함수를 호출하여 표현식을 구성합니다.
2. **표현식 트리 구성**: 파싱된 표현식들을 트리 형태로 구성합니다. 이 트리는 각 노드가 하나의 조건을 나타내며, 트리를 순회하면서 각 조건을 평가하여 전체 표현식의 결과를 도출합니다.
3. **트리 최적화**: 표현식 트리를 최적화하여 평가 시간을 줄입니다. 트리의 노드를 재배치하여 평가 순서를 변경하고, 가능한 경우 일부 조건의 평가를 생략하도록 합니다.
4. **디버깅 정보 출력**: 디버깅 옵션이 활성화된 경우, 표현식 트리와 최적화된 명령 줄을 출력합니다. 이 정보는 표현식의 구조와 최적화 과정을 이해하는 데 도움이 됩니다.
    

이 함수의 결과는 최적화된 표현식 트리입니다. 이 트리는 후속 처리에서 사용되어, 각 파일이 주어진 조건에 맞는지 평가하는 데 사용됩니다. 이 함수는 주어진 인수들을 통해 표현식을 구성하고 최적화하는 역할을 합니다. 이 과정에서 여러 가지 오류 상황을 체크하고, 오류가 발생하면 적절한 에러 메시지를 출력하고 프로그램을 종료합니다. 이는 입력된 인수들이 올바른 표현식을 형성하지 않는 경우에 발생합니다. 이러한 방식으로, 이 함수는 표현식의 구성과 검증을 담당하며, 이를 통해 파일 검색 조건을 효과적으로 처리합니다.