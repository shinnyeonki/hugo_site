<!DOCTYPE html>

<html lang="en-US"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    
    
    
    <title> | My Test Site</title>
    

    
    
    <meta name="description" content="현재 코드는 순차적으로 포트를 검사하는 방식을 사용하고 있기 때문에, 특히 BASE_PORT에서 시작하여 MAX_PORT까지의 범위가 넓을 경우 검색 시간이 오래 걸릴 수 있습니다. 이를 개선하기 위해 다음과 같은 방법들을 고려할 수 있습니다.
1. 랜덤 포트 할당 순 …">

    
    
    <meta name="robots" content="index, follow">
    

    
    <link rel="canonical" href="http://localhost:1313/06.university/mju_ecs-project/%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88-%ED%8F%AC%ED%8A%B8-%ED%95%A0%EB%8B%B9/">

    
    
    
    <meta property="og:title" content="">
    <meta property="og:description" content="현재 코드는 순차적으로 포트를 검사하는 방식을 사용하고 있기 때문에, 특히 BASE_PORT에서 시작하여 MAX_PORT까지의 범위가 넓을 경우 검색 시간이 오래 걸릴 수 있습니다. 이를 개선하기 위해 다음과 같은 방법들을 고려할 수 있습니다.
1. 랜덤 포트 할당 순 …">
    <meta property="og:url" content="http://localhost:1313/06.university/mju_ecs-project/%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88-%ED%8F%AC%ED%8A%B8-%ED%95%A0%EB%8B%B9/">
    <meta property="og:site_name" content="My Test Site">
    
    <meta property="og:type" content="blog">
    

    
    
    

    
    
    
    <meta name="twitter:card" content="summary_large_image">
    
    <meta name="twitter:title" content="">
    <meta name="twitter:description" content="현재 코드는 순차적으로 포트를 검사하는 방식을 사용하고 있기 때문에, 특히 BASE_PORT에서 시작하여 MAX_PORT까지의 범위가 넓을 경우 검색 시간이 오래 걸릴 수 있습니다. 이를 개선하기 위해 다음과 같은 방법들을 고려할 수 있습니다.
1. 랜덤 포트 할당 순 …">
    

    
    
    

    
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>

</head><body>
    
     
    <header class="site-header">
        <div class="site-title">
            <a href="http://localhost:1313/">My Test Site</a>
        </div>
    </header>
    
    <nav class="site-nav">
        <ul>
            
        </ul>
    </nav>
    
    <main>
        
        
<article class="prose prose-sm lg:prose-base max-w-3xl mx-auto dk:prose-stone">
    <h1> **page.html**</h1>
    <p>현재 코드는 순차적으로 포트를 검사하는 방식을 사용하고 있기 때문에, 특히 <code>BASE_PORT</code>에서 시작하여 <code>MAX_PORT</code>까지의 범위가 넓을 경우 검색 시간이 오래 걸릴 수 있습니다. 이를 개선하기 위해 다음과 같은 방법들을 고려할 수 있습니다.</p>
<hr>
<h2 id="1-랜덤-포트-할당"><strong>1. 랜덤 포트 할당</strong></h2>
<p>순차적으로 검사하는 대신, 주어진 범위 내에서 랜덤하게 포트를 선택하여 검사하면 평균적으로 더 빠르게 사용 가능한 포트를 찾을 수 있습니다.</p>
<h3 id="수정된-코드">수정된 코드</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">import</span> java.util.Random;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * 주어진 범위에서 사용 가능한 포트를 랜덤하게 찾습니다.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param startPort 시작 포트
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param endPort   종료 포트
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @return 사용 가능한 포트 번호, 없으면 -1 반환
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">findAvailablePort</span>(<span style="color:#66d9ef">int</span> startPort, <span style="color:#66d9ef">int</span> endPort) {
</span></span><span style="display:flex;"><span>    Random random <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Random();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> attempts <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> maxAttempts <span style="color:#f92672">=</span> (endPort <span style="color:#f92672">-</span> startPort <span style="color:#f92672">+</span> 1); <span style="color:#75715e">// 최대 시도 횟수</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (attempts <span style="color:#f92672">&lt;</span> maxAttempts) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> port <span style="color:#f92672">=</span> startPort <span style="color:#f92672">+</span> random.<span style="color:#a6e22e">nextInt</span>(endPort <span style="color:#f92672">-</span> startPort <span style="color:#f92672">+</span> 1);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (isPortAvailable(port)) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> port;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        attempts<span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span>1; <span style="color:#75715e">// 사용 가능한 포트가 없는 경우</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="장점">장점</h3>
<ul>
<li>순차 검색보다 평균적으로 더 빠르게 사용 가능한 포트를 찾을 가능성이 높습니다.</li>
<li>랜덤성을 통해 특정 포트에 대한 경쟁 상태를 줄일 수 있습니다.</li>
</ul>
<h3 id="단점">단점</h3>
<ul>
<li>매우 드물지만, 모든 포트가 사용 중인 경우 최악의 경우에도 많은 시도가 필요할 수 있습니다.</li>
</ul>
<hr>
<h2 id="2-할당된-포트-캐싱"><strong>2. 할당된 포트 캐싱</strong></h2>
<p>이미 할당된 포트를 관리하는 데이터 구조(예: <code>Set&lt;Integer&gt;</code>)를 사용하여, 중복 검사를 피하고 빠르게 사용 가능한 포트를 찾을 수 있습니다.</p>
<h3 id="수정된-코드-1">수정된 코드</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">import</span> java.util.HashSet;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.util.Set;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> Set<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">&gt;</span> allocatedPorts <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> HashSet<span style="color:#f92672">&lt;&gt;</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * 주어진 범위에서 사용 가능한 포트를 빠르게 찾습니다.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param startPort 시작 포트
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param endPort   종료 포트
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @return 사용 가능한 포트 번호, 없으면 -1 반환
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">synchronized</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">findAvailablePort</span>(<span style="color:#66d9ef">int</span> startPort, <span style="color:#66d9ef">int</span> endPort) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> port <span style="color:#f92672">=</span> startPort; port <span style="color:#f92672">&lt;=</span> endPort; port<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>allocatedPorts.<span style="color:#a6e22e">contains</span>(port) <span style="color:#f92672">&amp;&amp;</span> isPortAvailable(port)) {
</span></span><span style="display:flex;"><span>            allocatedPorts.<span style="color:#a6e22e">add</span>(port); <span style="color:#75715e">// 할당된 포트를 캐싱</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> port;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span>1; <span style="color:#75715e">// 사용 가능한 포트가 없는 경우</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * 컨테이너 종료 시 할당된 포트를 해제합니다.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param port 해제할 포트
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">synchronized</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">releasePort</span>(<span style="color:#66d9ef">int</span> port) {
</span></span><span style="display:flex;"><span>    allocatedPorts.<span style="color:#a6e22e">remove</span>(port);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="사용-예시">사용 예시</h3>
<p>컨테이너가 종료될 때 할당된 포트를 해제하는 로직을 추가합니다:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// ttydLauncherService에서 컨테이너 종료 시 호출</span>
</span></span><span style="display:flex;"><span>releasePort(port);
</span></span></code></pre></div><h3 id="장점-1">장점</h3>
<ul>
<li>이미 할당된 포트를 관리하므로 불필요한 검사를 피할 수 있습니다.</li>
<li>동기화(<code>synchronized</code>)를 통해 멀티스레드 환경에서도 안전하게 포트를 관리할 수 있습니다.</li>
</ul>
<h3 id="단점-1">단점</h3>
<ul>
<li>메모리에 할당된 포트 목록을 유지해야 하며, 프로그램이 종료되면 목록이 사라집니다.</li>
</ul>
<hr>
<h2 id="3-운영체제의-임시-포트-활용"><strong>3. 운영체제의 임시 포트 활용</strong></h2>
<p>Java의 <code>ServerSocket(0)</code>은 운영체제가 자동으로 사용 가능한 포트를 할당하도록 요청합니다. 이 방식은 가장 빠르고 간단하지만, 할당된 포트가 범위(<code>9000 ~ 36000</code>) 내에 있는지 보장되지 않습니다.</p>
<h3 id="수정된-코드-2">수정된 코드</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">findAvailablePortInRange</span>(<span style="color:#66d9ef">int</span> startPort, <span style="color:#66d9ef">int</span> endPort) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> (ServerSocket serverSocket <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ServerSocket(0)) { <span style="color:#75715e">// OS가 임시 포트 할당</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> port <span style="color:#f92672">=</span> serverSocket.<span style="color:#a6e22e">getLocalPort</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (port <span style="color:#f92672">&gt;=</span> startPort <span style="color:#f92672">&amp;&amp;</span> port <span style="color:#f92672">&lt;=</span> endPort) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> port;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">catch</span> (IOException e) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 무시</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span>1; <span style="color:#75715e">// 범위 내의 포트를 할당할 수 없는 경우</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="장점-2">장점</h3>
<ul>
<li>운영체제가 가장 빠르게 사용 가능한 포트를 제공합니다.</li>
<li>별도의 포트 검사 로직이 필요 없습니다.</li>
</ul>
<h3 id="단점-2">단점</h3>
<ul>
<li>할당된 포트가 지정된 범위(<code>9000 ~ 36000</code>)를 벗어날 가능성이 있습니다.</li>
<li>특정 범위 내에서만 포트를 사용해야 하는 경우 적합하지 않을 수 있습니다.</li>
</ul>
<hr>
<h2 id="4-병렬-처리"><strong>4. 병렬 처리</strong></h2>
<p>포트 검사를 병렬로 수행하여 성능을 향상시킬 수 있습니다. 예를 들어, 여러 스레드가 동시에 다른 포트를 검사하도록 할 수 있습니다.</p>
<h3 id="수정된-코드-3">수정된 코드</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">import</span> java.util.concurrent.ExecutorService;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.util.concurrent.Executors;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.util.concurrent.atomic.AtomicInteger;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">findAvailablePortParallel</span>(<span style="color:#66d9ef">int</span> startPort, <span style="color:#66d9ef">int</span> endPort) {
</span></span><span style="display:flex;"><span>    AtomicInteger availablePort <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> AtomicInteger(<span style="color:#f92672">-</span>1);
</span></span><span style="display:flex;"><span>    ExecutorService executor <span style="color:#f92672">=</span> Executors.<span style="color:#a6e22e">newFixedThreadPool</span>(10); <span style="color:#75715e">// 10개의 스레드 사용</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> port <span style="color:#f92672">=</span> startPort; port <span style="color:#f92672">&lt;=</span> endPort; port<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> currentPort <span style="color:#f92672">=</span> port;
</span></span><span style="display:flex;"><span>        executor.<span style="color:#a6e22e">submit</span>(() <span style="color:#f92672">-&gt;</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (availablePort.<span style="color:#a6e22e">get</span>() <span style="color:#f92672">==</span> <span style="color:#f92672">-</span>1 <span style="color:#f92672">&amp;&amp;</span> isPortAvailable(currentPort)) {
</span></span><span style="display:flex;"><span>                availablePort.<span style="color:#a6e22e">set</span>(currentPort);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    executor.<span style="color:#a6e22e">shutdown</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (<span style="color:#f92672">!</span>executor.<span style="color:#a6e22e">isTerminated</span>()) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 모든 작업이 완료될 때까지 대기</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> availablePort.<span style="color:#a6e22e">get</span>();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="장점-3">장점</h3>
<ul>
<li>병렬 처리를 통해 포트 검색 속도를 크게 향상시킬 수 있습니다.</li>
</ul>
<h3 id="단점-3">단점</h3>
<ul>
<li>복잡도가 증가하며, 과도한 스레드 사용으로 인해 리소스를 많이 소비할 수 있습니다.</li>
</ul>
<hr>
<h2 id="결론"><strong>결론</strong></h2>
<p>가장 적합한 방법은 요구사항과 환경에 따라 다릅니다:</p>
<ol>
<li><strong>빠른 해결</strong>: 랜덤 포트 할당(<code>Random</code>)을 사용하세요.</li>
<li><strong>안정성과 효율성</strong>: 할당된 포트를 캐싱(<code>Set</code>)하는 방법을 추천합니다.</li>
<li><strong>범위 제한이 필요 없는 경우</strong>: 운영체제의 임시 포트(<code>ServerSocket(0)</code>)를 활용하세요.</li>
<li><strong>대규모 환경</strong>: 병렬 처리를 사용하여 성능을 최적화하세요.</li>
</ol>
<p>추가적인 질문이나 요구사항이 있다면 말씀해주세요! 😊</p>

</article>


        
        <footer class="site-footer">
            
            <address>
                
            </address>
            <p>&copy; 2025 My Test Site. All rights reserved.</p>
        </footer>
    </main>

    
    <aside class="sidebar">
        <h3>최근 글</h3>
        <ul>
            
            <li><a href="http://localhost:1313/signal-%EC%B0%A8%EC%9D%B4-unixmacos-vs-linux/">signal 차이 unix(macos) vs linux</a></li>
            
            <li><a href="http://localhost:1313/02.inbox/doxyzen-%ED%82%A4%EC%9B%8C%EB%93%9C/">Doxyzen 키워드</a></li>
            
            <li><a href="http://localhost:1313/02.inbox/%EB%B0%B1%EC%97%94%EB%93%9C-%EA%B5%AC%EC%A1%B0-%EB%B3%80%ED%99%94-%EC%97%AD%EC%82%AC/">백엔드 구조 변화 역사</a></li>
            
            <li><a href="http://localhost:1313/%EC%BD%94%EC%96%B4-%EB%8D%A4%ED%94%84core-dump/">코어 덤프(Core Dump)</a></li>
            
            <li><a href="http://localhost:1313/copilot/copilot-custom-prompts/translate-to-chinese/">Translate to Chinese</a></li>
            
        </ul>

        <h3>태그</h3>
        
        
    </aside>
</body>
</html>